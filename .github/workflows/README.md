# æŠ•èµ„æ¨¡æ‹Ÿç³»ç»Ÿ - å®Œæ•´åç«¯ç‰ˆ

å®Œæ•´çš„æŠ•èµ„æ¨¡æ‹Ÿç³»ç»Ÿï¼ŒåŒ…å«å‰ç«¯HTMLå’Œåç«¯Node.js APIã€‚

## ğŸ“‹ åŠŸèƒ½ç‰¹æ€§

### ç”¨æˆ·åŠŸèƒ½
- âœ… ç”¨æˆ·ç™»å½•è®¤è¯ï¼ˆJWTï¼‰
- âœ… æŸ¥çœ‹ä¸ªäººèµ„é‡‘å’Œæ”¶ç›Šç‡
- âœ… é€‰æ‹©æŠ•èµ„é¡¹ç›®
- âœ… æŸ¥çœ‹æŠ•èµ„å†å²è®°å½•
- âœ… æŠ•èµ„çŠ¶æ€é”å®šæœºåˆ¶

### ç®¡ç†å‘˜åŠŸèƒ½
- âœ… æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·æŠ•èµ„æƒ…å†µ
- âœ… æ·»åŠ /åˆ é™¤æŠ•èµ„é¡¹ç›®
- âœ… è®¾ç½®å¸‚åœºæ¶¨è·Œç™¾åˆ†æ¯”
- âœ… ç»“ç®—ç³»ç»Ÿï¼ˆè‡ªåŠ¨è®¡ç®—æ”¶ç›Šï¼‰
- âœ… æœŸæ•°ç®¡ç†

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
cd investment-backend
npm install
```

### 2. åˆå§‹åŒ–æ•°æ®åº“

```bash
node init-database.js
```

è¿™å°†åˆ›å»ºï¼š
- ç®¡ç†å‘˜è´¦å·: `admin` / `admin`
- 40ä¸ªç”¨æˆ·è´¦å·: `user1-user40` / `1234`
- åˆå§‹é¡¹ç›®: é»„é‡‘ã€è‚¡ç¥¨ã€å€ºåˆ¸

### 3. å¯åŠ¨åç«¯æœåŠ¡å™¨

```bash
npm start
```

æˆ–ä½¿ç”¨å¼€å‘æ¨¡å¼ï¼ˆè‡ªåŠ¨é‡å¯ï¼‰ï¼š

```bash
npm run dev
```

æœåŠ¡å™¨å°†åœ¨ `http://localhost:3000` å¯åŠ¨

### 4. æ‰“å¼€å‰ç«¯é¡µé¢

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `index.html` æ–‡ä»¶

**é‡è¦**: ç¡®ä¿å‰ç«¯HTMLä¸­çš„ `API_URL` è®¾ç½®æ­£ç¡®ï¼š
```javascript
const API_URL = 'http://localhost:3000/api';
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
investment-backend/
â”œâ”€â”€ server.js           # ä¸»æœåŠ¡å™¨æ–‡ä»¶
â”œâ”€â”€ database.js         # æ•°æ®åº“è¿æ¥æ¨¡å—
â”œâ”€â”€ middleware.js       # è®¤è¯ä¸­é—´ä»¶
â”œâ”€â”€ init-database.js    # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ package.json        # é¡¹ç›®ä¾èµ–
â”œâ”€â”€ .env                # ç¯å¢ƒé…ç½®
â”œâ”€â”€ index.html          # å‰ç«¯é¡µé¢
â””â”€â”€ database.sqlite     # SQLiteæ•°æ®åº“ï¼ˆè‡ªåŠ¨ç”Ÿæˆï¼‰
```

## ğŸ”Œ API ç«¯ç‚¹

### è®¤è¯
- `POST /api/login` - ç”¨æˆ·ç™»å½•

### ç”¨æˆ·ç«¯ç‚¹
- `GET /api/user` - è·å–ç”¨æˆ·ä¿¡æ¯
- `GET /api/user/history` - è·å–æŠ•èµ„å†å²
- `POST /api/user/invest` - ç¡®è®¤æŠ•èµ„

### é¡¹ç›®ç®¡ç†
- `GET /api/projects` - è·å–æ‰€æœ‰é¡¹ç›®
- `POST /api/projects` - æ·»åŠ é¡¹ç›®ï¼ˆç®¡ç†å‘˜ï¼‰
- `DELETE /api/projects/:name` - åˆ é™¤é¡¹ç›®ï¼ˆç®¡ç†å‘˜ï¼‰

### ç®¡ç†å‘˜ç«¯ç‚¹
- `GET /api/admin/users` - è·å–æ‰€æœ‰ç”¨æˆ·
- `GET /api/admin/period` - è·å–å½“å‰æœŸæ•°
- `POST /api/admin/settle` - æ‰§è¡Œç»“ç®—
- `GET /api/admin/user-chart/:username` - è·å–ç”¨æˆ·å›¾è¡¨æ•°æ®

## ğŸ—„ï¸ æ•°æ®åº“ç»“æ„

### users è¡¨
- id, username, password, role, credit, initial_credit, invested_project

### history è¡¨
- id, user_id, period, action, project, percentage, credit_before, credit_after

### projects è¡¨
- id, name

### periods è¡¨
- id, current_period

### market_data è¡¨
- id, period, project_name, percentage

## ğŸ” å®‰å…¨ç‰¹æ€§

- âœ… å¯†ç ä½¿ç”¨ bcrypt åŠ å¯†
- âœ… JWT Token è®¤è¯
- âœ… è§’è‰²æƒé™æ§åˆ¶
- âœ… SQL æ³¨å…¥é˜²æŠ¤
- âœ… CORS è·¨åŸŸæ”¯æŒ

## ğŸ“ ä½¿ç”¨æµç¨‹

1. **ç”¨æˆ·ç™»å½•**
   - ä½¿ç”¨ç”¨æˆ·åå¯†ç ç™»å½•
   - ç³»ç»Ÿè¿”å› JWT Token

2. **ç”¨æˆ·æŠ•èµ„**
   - é€‰æ‹©æŠ•èµ„é¡¹ç›®
   - ç¡®è®¤æŠ•èµ„ï¼ˆèµ„é‡‘é”å®šï¼‰

3. **ç®¡ç†å‘˜ç»“ç®—**
   - è®¾ç½®å„é¡¹ç›®æ¶¨è·Œç™¾åˆ†æ¯”
   - æ‰§è¡Œç»“ç®—
   - ç³»ç»Ÿè‡ªåŠ¨è®¡ç®—æ‰€æœ‰ç”¨æˆ·æ”¶ç›Š

4. **æŸ¥çœ‹å†å²**
   - ç”¨æˆ·å¯æŸ¥çœ‹ä¸ªäººæŠ•èµ„å†å²
   - ç®¡ç†å‘˜å¯æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·æ•°æ®

## âš™ï¸ ç¯å¢ƒé…ç½®

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼š

```env
PORT=3000                          # æœåŠ¡å™¨ç«¯å£
JWT_SECRET=your_secret_key         # JWTå¯†é’¥ï¼ˆç”Ÿäº§ç¯å¢ƒè¯·ä¿®æ”¹ï¼‰
DATABASE_PATH=./database.sqlite    # æ•°æ®åº“è·¯å¾„
```

## ğŸ”§ å¼€å‘æç¤º

### é‡ç½®æ•°æ®åº“
```bash
rm database.sqlite
node init-database.js
```

### æŸ¥çœ‹æ•°æ®åº“
```bash
sqlite3 database.sqlite
.tables
SELECT * FROM users;
```

### æµ‹è¯•API
```bash
# ç™»å½•
curl -X POST http://localhost:3000/api/login \
  -H "Content-Type: application/json" \
  -d '{"username":"user1","password":"1234"}'

# è·å–ç”¨æˆ·ä¿¡æ¯
curl http://localhost:3000/api/user \
  -H "Authorization: Bearer YOUR_TOKEN"
```

## ğŸ“Š æ•°æ®æµç¨‹

```
ç”¨æˆ·ç™»å½• â†’ è·å–Token â†’ é€‰æ‹©é¡¹ç›® â†’ ç¡®è®¤æŠ•èµ„ â†’ ç­‰å¾…ç»“ç®—
                                              â†“
ç®¡ç†å‘˜ç™»å½• â†’ è®¾ç½®æ¶¨è·Œ â†’ æ‰§è¡Œç»“ç®— â†’ æ›´æ–°æœŸæ•° â† è®¡ç®—æ”¶ç›Š
```

## ğŸ› æ•…éšœæ’æŸ¥

### è¿æ¥é”™è¯¯
- ç¡®ä¿åç«¯æœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
- æ£€æŸ¥ `API_URL` æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥æµè§ˆå™¨æ§åˆ¶å°é”™è¯¯

### ç™»å½•å¤±è´¥
- ç¡®è®¤ç”¨æˆ·åå¯†ç æ­£ç¡®
- æ£€æŸ¥æ•°æ®åº“æ˜¯å¦åˆå§‹åŒ–

### CORS é”™è¯¯
- ç¡®ä¿æœåŠ¡å™¨å·²å¯ç”¨ CORS
- æ£€æŸ¥è¯·æ±‚å¤´æ˜¯å¦æ­£ç¡®

## ğŸ“¦ éƒ¨ç½²å»ºè®®

### ç”Ÿäº§ç¯å¢ƒ
1. ä¿®æ”¹ `.env` ä¸­çš„ `JWT_SECRET`
2. ä½¿ç”¨ PM2 ç®¡ç†è¿›ç¨‹
3. é…ç½® Nginx åå‘ä»£ç†
4. å¯ç”¨ HTTPS
5. å®šæœŸå¤‡ä»½æ•°æ®åº“

```bash
# ä½¿ç”¨ PM2
npm install -g pm2
pm2 start server.js --name investment-api
pm2 save
```

## ğŸ“„ è®¸å¯è¯

MIT License

## ğŸ‘¨â€ğŸ’» æŠ€æœ¯æ ˆ

- **åç«¯**: Node.js + Express
- **æ•°æ®åº“**: SQLite3
- **è®¤è¯**: JWT + bcrypt
- **å‰ç«¯**: åŸç”Ÿ HTML/CSS/JavaScript

---

**å¼€å‘è€…**: Claude AI Assistant
**ç‰ˆæœ¬**: 1.0.0
**æ›´æ–°æ—¥æœŸ**: 2026-01-28
